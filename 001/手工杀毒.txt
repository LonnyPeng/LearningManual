xp系统一、自己动手前，切记有备无患――用TaskList备份系统进程 

新型病毒都学会了用进程来隐藏自己，所以我们最好在系统正常的 时候，备份一下电脑的 进程列表，当然最好在刚进入Windows时不要运行任何程序的 情况下备份，样以后感觉电脑异常的 时候可以通过比较进程列表，找出可能是病毒的 进程。 

在命令提示符下输入： 

TaskList /fo:csv>g:zc.csv 

上述命令的 作用是将当前进程列表以csv格式输出到“zc.csv”文件中，g:为你要保存到的 盘，可以用Excel打开该文件. 

二、自己动手时，必须火眼金睛――用FC比较进程列表文件 

如果感觉电脑异常，或者知道最近有流行病毒，那么就有必要检查一下。 

进入命令提示符下，输入下列命令： 

TaskList /fo:csv>g:yc.csv 

生成一个当前进程的 yc.csv文件列表，然后输入： 

FC g:\zccsv g:\yc.csy 

回车后就可以看到前后列表文件的 不同了，通过比较发现，电脑多了一个名为“Winion0n.exe”(这 里以这 个进程为例)不是“Winionon.exe”的 异常进程。 

三、进行判断时，切记证据确凿――用Netstat查看开放端口 

对这 样的 可疑进程，如何判断它是否是病毒呢？根据大部分病毒（特别是木马）会通过端口进行对外连接来传播病毒，可以查看一下端口占有情况。 

在命令提示符下输入： 

Netstat -a-n-o 

参数含义如下： 

a:显示所有与该主机建立连接的 端口信息 

n:显示打开端口进程PID代码 

o：以数字格式显示地址和端口信息 

回车后就可以看到所有开放端口和外部连接进程，这 里一个PID为1756（以此为例）的 进程最为可疑，它的 状态是“ESTABLISHED”，通过任务管理器可以知道这 个进程就是“Winion0n.exe”，通过查看本机运行网络程序，可以判断这 是一个非法连接！ 

连接参数含义如下： 

LISTENINC：表示处于侦听状态，就是说该端口是开放的 ，等待连接，但还没有被连接，只有TCP协议的 服务端口才能处于LISTENINC状态。 

ESTABLISHED的 意思是建立连接。 

表示两台机器正在通信。 

TIME-WAIT意思是结束了这 次连接。 

说明端口曾经有过访问，但访问结束了，用于判断是否有外部电脑连接到本机。 

四：下手杀毒时，一定要心狠手辣――用NTSD终止进程 

虽然知道 “Winion0n.exe”是个非法进程，但是很多病毒的 进程无法通过任务管理器终止，怎么办？ 

在命令提示符下输入下列命令： 

ntsd Cc q-p 1756 

回车后可以顺利结束病毒进程。 

提示：“1756”为进程PID值，如果不知道进程的 ID，打开任务管理器，单击“查看→选择列→勾上PID（进程标识符）即可。 

NTSD可以强行终止除Sytem,SMSS.EXE,CSRSS.EXE外的 所有进程。 

五、断定病毒后，定要斩草除根――搜出病毒原文件 

对于已经判断是病毒文件的 “Winion0n.exe”文件，通过搜索“本地所有分区”、“搜索系统文件夹和隐藏的 文件和文件夹”，找到该文件的 藏身之所，将它删除。 

不过这 样删除的 只是病毒主文件，通过查看它的 属性，依据它的 文件创建曰期、大小再次进行搜索，找出它的 同伙并删除。 

如果你不确定还有那些文件是它的 亲戚，通过网络搜索查找病毒信息获得帮助。 

六、清除病毒后一定要打扫战场 

手动修复注册表虽然把病毒文件删除了，但病毒都会在注册表留下垃圾键值，还需要把这 些垃圾清除干净。 

1、用reg export备份自启动。 

由于自启动键值很多，发现病毒时手动查找很不方便。 

这 里用reg export+批处理命令来备份。 

启动记事本输入下列命令： 

reg export HKLM\software\Microsoft\Windows\ 

CurrentVersion\Run fo:\hklmrun.reg 

reg export HKCU\Software\Microsoft\Windows\ 

CurrentVersion\Policies\Explorer\Run f:\hklcu.reg 

reg export HKLM\SOFTWARE\Microsoft\Windows\ 

CurrentVersion\Policies\Explorer\Run hklml.reg 

注：这 里只列举几个常见键值的 备份，其它键值请参照上述方法制作。 

然后将它保存为ziqidong.bat在命令提示符下运行它，即可将所有自启动键值备份到相应的 reg文件中，接着再输入： 

copy f:\*.reg ziqidong.txt 

命令的 作用是将所有备份的 reg文件输出到“ziqidong.txt”中，这 样如果发现病毒新增自启动项，同上次导出自启动值，利用上面介绍的 FC命令比较前后两个txt文件，即可快速找出新增自启动项目。 

2、用reg delete删除新增自启动键值。 

比如：通过上面的 方法在[HKER_CURRENT_USER\SOFTWARE\Microsoft\ 

Windows\CurrentVersion\Run],找到一个“Logon”自启动项，启动程序为“c:\windows\winlogon.exe”,现在输入下列命令即可删除病毒自启动键值： 

reg delete HKLM\software\Microssoft\Windows\ 

CurrentVersion\Run /f 

3、用reg import恢复注册表。 

Reg de-lete删除是的 是整个RUN键值，现在用备份好的 reg文件恢复即可，输入下列命令即可迅速还原注册表：reg import f:\hklmrun.reg 

上面介绍手动杀毒的 几个系统命令，其实只要用好这 些命令，我们基本可以KILL掉大部分的 病毒，当然平时就一定要做好备份工作。 

提示：上述操作也可以在注册表编辑器里手动操作，但是REG命令有个好处，那就是即使注册表编辑器被病毒设置为禁用，也可以通过上述命令导出/删除/导入操作，而且速度更快！ 

七、捆绑木马克星――FIND 

上面介绍利用系统命令查杀一般病毒，下面再介绍一个检测捆绑木马的 “FIND”命令。 

相信很很多网虫都遭遇过捆绑木刀，这 些“批着羊皮的 狼”常常躲在图片、FLASH、甚至音乐文件后面。 

当我们打开这 些文件的 时候，虽然在当前窗口显示的 确实是一幅图片（或是播放的 FLASH），但可恶的 木马却已经在后台悄悄地运行了。 

比如近曰我就收到一张好友从QQ传来的 超女壁纸，但是当我打开图片时却发现：图片已经用“图片和传真查看器”打开了，硬盘的 指示灯却一直在狂闪。 

显然在我打开图片的 同时，有不明的 程序在后台运行。 

现在用FIND命令检测图片是否捆绑木马，在命令提示符输入： 

FIND /c /I“This program”g:\chaonv.jpe.exe其中: 

g:\chaonv.jpe.exe表示需要检测的 文件 

FIND命令返回的 提示是“___G:CHAONV.EXE: 2”,这 表明“G：、CHAONV.EXE”确实捆绑了其它文件。 

因为FIND命令的 检测：如果是EXE文件，正常情况下返回值应该为“1”；如果是不可执行文件，正常情况下返回值应该为“0”，其它结果就要注意了。 

提示：其实很多捆绑木马是利用Windows默认的 “隐藏已知类型文件扩展名”来迷惑我们，比如本例的 “chaonv.jpe.exe”，由于这 个文件采用了JPG文件的 图标，才导致上当。 

打开“我的 电脑”，单击“工具→文件夹选项”，“单击”“查看”，去除“隐藏已知类型文件扩展名”前的 小勾，即可看清“狼”的 真面目。 

八、总结 

最后我们再来总结一下手动毒的 流程： 

用TSKLIST备份好进程列表→通过FC比较文件找出病毒→用NETSTAT判断进程→用FIND终止进程→搜索找出病毒并删除→用REG命令修复注册表。 

这 样从发现病毒、删除病毒、修复注册表，这 完成整个手动查毒、杀毒过程。
  
